import { useState, useMemo, useEffect } from 'react'
import { Avatar, Col, Row, Tooltip, Spin } from 'antd'
import { GithubFilled, MailFilled, WechatFilled } from '@ant-design/icons'

import apiMap from '../config/apiMap'
import localUtil from './util/localUtil'
import { httpPost } from './util/httpUtil'

import '../static/style/component/sns.css'


const size = 25,
    GRID = 'grid',
    placement = "bottom",
    trigger = ['click', 'hover']


var dataMap
const Sns = ({ mode }) => {

    const [spinning, setSpinning] = useState(!dataMap)

    useEffect(() => {
        (dataMap = localUtil.getObj('snsMap')) ?
            spinning && setSpinning(false) :
            httpPost({
                url: apiMap.snsMap,
                cb: data => {
                    localUtil.setObj('snsMap', dataMap = data)
                    spinning && setSpinning(false)
                }
            })
    }, [])

    const email = useMemo(() => (
        dataMap &&
        <Tooltip trigger={trigger} placement={placement} title={dataMap.email.label}  >
            <span>
                <svg t="1595833002383" class="icon-email" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path d="M1024 512c0-282.763636-229.236364-512-512-512C229.236364 0 0 229.236364 0 512c0 282.763636 229.236364 512 512 512C794.763636 1024 1024 794.763636 1024 512zM835.630545 707.956364l-176.221091-148.48 42.868364-24.203636 156.206545 125.533091L835.630545 707.956364zM162.909091 325.818182l349.090909 209.454545L861.090909 325.818182l0 46.545455L512 581.818182 162.909091 372.363636 162.909091 325.818182zM170.263273 698.507636l-22.807273-47.150545 156.16-125.533091 42.868364 24.203636L170.263273 698.507636z"></path></svg>
            </span>
        </Tooltip>
    ), [spinning])

    const wechat = useMemo(() => (
        dataMap &&
        <Tooltip trigger={trigger} placement={placement} title={(<img src={dataMap.wechat.label} />)} overlayStyle={{ width: 200 }} >
            <span>
                <svg t="1595830734304" class="icon-wechat" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <path d="M332.820602 413.878041c-12.798544 4.266181-29.86327-4.266181-34.129451-21.330907-4.266181-17.064726 4.266181-34.129451 21.330906-34.129451h12.798545c17.064726 0 29.86327 12.798544 29.863269 29.86327 0 12.798544-12.798544 25.597088-29.863269 25.597088z m174.913437 0c-17.064726 4.266181-34.129451-4.266181-38.395633-21.330907-4.266181-17.064726 4.266181-34.129451 21.330907-38.395632h12.798544c17.064726 0 29.86327 12.798544 29.86327 29.86327 4.266181 17.064726-8.532363 29.86327-25.597088 29.863269z m81.057446 162.114893c-12.798544 0-25.597088-8.532363-25.597088-21.330907s8.532363-25.597088 21.330907-25.597088c12.798544-4.266181 25.597088 4.266181 29.863269 17.064725 4.266181 12.798544-4.266181 25.597088-17.064725 29.86327h-8.532363z m136.517804 0c-12.798544 0-25.597088-8.532363-25.597088-21.330907s8.532363-25.597088 21.330907-25.597088c12.798544-4.266181 25.597088 4.266181 29.86327 17.064725 4.266181 12.798544-4.266181 25.597088-17.064726 29.86327H725.309289z m-68.258902-140.783986c-119.453079 0-209.042888 76.791265-209.042888 170.647256s93.855991 170.647256 209.042888 170.647255c25.597088 0 51.194177-4.266181 72.525084-12.798544l68.258902 34.129451-17.064726-59.726539c46.927995-29.86327 81.057446-81.057446 85.323628-136.517805 0-89.589809-98.122172-166.381074-209.042888-166.381074zM413.878048 256.02933c-136.517804 0-247.438521 89.589809-247.438521 200.510525 4.266181 68.258902 38.395632 127.985442 98.122172 157.848712l-25.597088 72.525083 85.323628-42.661814c29.86327 8.532363 55.460358 12.798544 85.323628 12.798545h21.330907c-4.266181-17.064726-8.532363-34.129451-8.532363-51.194177 4.266181-110.920716 98.122172-191.978162 209.042888-187.711981h25.597088C644.251843 328.554414 537.597308 256.02933 413.878048 256.02933z m102.388353 767.91265C234.69843 1028.208161 4.324635 797.834366 0.058453 516.266395-4.207728 234.698423 226.166067 4.324628 507.734039 0.058447s511.941767 226.107614 516.207948 507.675585v4.266181c0 281.567972-226.107614 511.941767-507.675586 511.941767z" ></path>
                </svg>
            </span>
        </Tooltip>
    ), [spinning])

    const github = useMemo(() => (
        dataMap &&
        <Tooltip title={dataMap.github.label} placement={placement}>
            <a href={dataMap.github.label} target="_blank">
                <svg t="1595831794273" class="icon-github" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path d="M512 0C229.283787 0 0.142041 234.942803 0.142041 524.867683c0 231.829001 146.647305 428.553077 350.068189 497.952484 25.592898 4.819996 34.976961-11.38884 34.976961-25.294314 0-12.45521-0.469203-45.470049-0.725133-89.276559-142.381822 31.735193-172.453477-70.380469-172.453477-70.380469-23.246882-60.569859-56.816233-76.693384-56.816234-76.693385-46.493765-32.58829 3.540351-31.948468 3.540351-31.948467 51.356415 3.71097 78.356923 54.086324 78.356923 54.086324 45.683323 80.19108 119.817417 57.072162 148.993321 43.593236 4.649376-33.91059 17.915029-57.029508 32.50298-70.167195-113.675122-13.222997-233.151301-58.223843-233.1513-259.341366 0-57.285437 19.919806-104.163095 52.678715-140.846248-5.246544-13.265652-22.820334-66.626844 4.990615-138.884127 0 0 42.996069-14.076094 140.760939 53.787741 40.863327-11.644769 84.627183-17.445825 128.177764-17.6591 43.465272 0.213274 87.271782 6.014331 128.135109 17.6591 97.679561-67.906489 140.59032-53.787741 140.59032-53.787741 27.938914 72.257282 10.407779 125.618474 5.118579 138.884127 32.844219 36.683154 52.593405 83.560812 52.593405 140.846248 0 201.586726-119.646798 245.990404-233.663158 258.957473 18.341577 16.208835 34.721032 48.199958 34.721032 97.210357 0 70.167195-0.639822 126.7275-0.639823 143.960051 0 14.033439 9.213443 30.370239 35.190235 25.209005 203.250265-69.527373 349.769606-266.123484 349.769605-497.867175C1023.857959 234.942803 794.673558 0 512 0"></path></svg>
            </a>
        </Tooltip>
    ), [spinning])


    return (
        <div className='sns'>
            <Spin
                spinning={spinning}
            >
                {
                    GRID == mode ?
                        <Row className="grid" justify="end">
                            <Col xs={0} sm={0} md={0} lg={5}>{email}</Col>
                            <Col xs={0} sm={0} md={8} lg={5}>{wechat}</Col>
                            <Col xs={24} sm={24} md={8} lg={5} > {github}</Col>
                        </Row>
                        :
                        <>
                            {email}
                            {wechat}
                            {github}
                        </>
                }
            </Spin>
        </div>
    )
}

export default Sns